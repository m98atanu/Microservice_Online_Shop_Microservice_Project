package com.microservices.cart.service;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.microservices.cart.external.APIEndpoints.InventoryServiceEndpoints;
import com.microservices.cart.model.LineItem;
import com.microservices.cart.repository.CartEntityRepository;
import com.microservices.cart.repository.LineItemRepository;

@Service
public class CartService {
	@Autowired
	CartEntityRepository cartRepo;
	
	@Autowired
	LineItemRepository lineItemRepo;
	
	@Autowired
	InventoryServiceEndpoints inventoryServiceEndpoints;
	
	public boolean isQuantityAvailableInInventoryDb (List<LineItem> items){
		if(items != null) {
			return items.stream()
					.allMatch(item ->
						item.getQuantity() < inventoryServiceEndpoints.fetchInventoryByProductId(item.getProductId()).getBody().getQuantity()
					);
		}
		else return true; //to tell to create empty cart
	}
	
	
	
	
}
